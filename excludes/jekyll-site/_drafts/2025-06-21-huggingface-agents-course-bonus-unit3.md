---
title: "Hugging Face Agents Course Bonus Unit 3 - Agents in games with Pokemon"
date: "2025-06-21 15:24:02 +0900"
last_modified_at: "2025-06-21 15:24:02 +0900"
---

# Hugging Face Agents Course Bonus Unit 3 - Agents in games with Pokemon
## Introduction
### Want to go further?
#### 🕵️‍♂️ Covert Protocol by NVIDIA and Inworld AI",
#### 🤖 NEO NPCs by Ubisoft",
#### ⚔️ Mecha BREAK Featuring NVIDIA’s ACE",
#### 🧛‍♂️ Suck Up! by Proxima Enterprises",
#### Wait… Where Are the Agents?"

1. NVIDIAとInworld AIが共同開発した「Covert Protocol」は、GDC 2024で発表された技術デモであり、プレイヤーは私立探偵として、AI搭載のNPCとのリアルタイムな対話を通じてストーリーを進行させる。このデモはUnreal Engine 5を基盤とし、NVIDIAのAvatar Cloud Engine (ACE)とInworld AIの技術を活用して、NPCとのよりリアルなインタラクションを実現している。プレイヤーの質問に対してNPCがリアルタイムで応答し、その応答が物語に影響を与える点が特徴である。

2. UbisoftはGDC 2024で、「NEO NPCs」というプロトタイプを発表した。これは、生成AIによって駆動されるNPCのショーケースである。これらのNPCは、周囲の環境を認識し、過去のインタラクションを記憶し、プレイヤーと意味のある会話を行うことができる。このプロトタイプの目的は、より没入感のあるレスポンシブなゲーム世界を創造し、プレイヤーがNPCと真のインタラクションを体験できるようにすることである。

3. NVIDIAのACE技術を採用したマルチプレイヤーメカバトルゲーム「Mecha BREAK」では、AI搭載のNPCがゲーム世界に命を吹き込む。プレイヤーは自然言語を用いてこれらのNPCと対話することができ、NPCはGPT-4oの統合により、Webカメラを通じてプレイヤーやオブジェクトを認識する。この革新的な技術は、より没入感が高くインタラクティブなゲーム体験を提供することを目指している。

4. Proxima Enterprisesが開発した「Suck Up!」は、プレイヤーが吸血鬼となり、AI搭載のNPCを説得して家の中に招き入れることを目指すゲームである。各キャラクターは生成AIによって駆動されており、予測不能でダイナミックなインタラクションが可能になっている。このゲームは、すでに公開されており、AIを活用したゲームプレイの具体的な例として注目されている。

5. これらのデモやゲームの例は、LLM（大規模言語モデル）をゲームに統合する現状を紹介するものである。ただし、これらの例は、エージェント（自律的に行動するAI）の要素を含んでいない。LLMとエージェントの違い、そしてエージェントがもたらす追加機能については、後のセクションで詳しく解説される予定である。

## From LLMs to AI Agents
### The big limitation of Agents: it’s slow (for now)
1.  LLM（大規模言語モデル）を活用したNPCは、より自然で多様な対話が可能になるが、基本的に静的であり、プレイヤーの行動に反応するだけである。これに対し、Agentic AI（エージェント型AI）を搭載したNPCは、自律的に意思決定、行動計画、環境への適応を行うことができる。例えば、助けを求めに行ったり、罠を仕掛けたり、プレイヤーを避けたりするなど、プレイヤーが直接関与していなくても行動する。

2.  Agentic AIは、NPCに自律性（ゲームの状態に基づいた独立した意思決定）、適応性（プレイヤーの行動に応じた戦略の調整）、持続性（過去のインタラクションを記憶し、将来の行動に反映）を与える。これにより、NPCはプレイヤーの入力に反応するだけの存在から、ゲーム世界における積極的な参加者へと変わり、革新的なゲームプレイの可能性が開かれる。

3.  Agentic AIの大きな制限は、その処理速度である。推論と計画のプロセスは遅延を引き起こす可能性があり、DoomやSuper Mario Bros.のようなペースの速いゲームには適していない。Claude Plays Pokémonの例では、思考に必要なトークン数と行動に必要なトークン数を考慮すると、リアルタイムでのプレイを可能にするためには、全く異なるデコード戦略が必要になることがわかる。

4.  ほとんどのゲームは毎秒約30フレームで動作する必要があるため、リアルタイムAIエージェントは毎秒30回行動する必要があるが、これは現在のAgentic LLMでは実現不可能である。しかし、ポケモンなどのターンベースのゲームは、AIが十分に時間をかけて戦略的な意思決定を行うことができるため、理想的な候補となる。

## Build Your Own Pokemon Battle Agent
### 🧠 Poke-env
1.  Poke-env（ポケエンブ）は、もともと強化学習ボットの訓練用に開発されたPythonインターフェースですが、ここではエージェントAIのために再利用されています。これは、エージェントが簡単なAPIを通じてポケモンショーダウンと対話することを可能にします。また、エージェントが継承するPlayerクラスを提供し、グラフィカルインターフェースとの通信に必要なすべてをカバーします。


### ⚔️ Pokémon Showdown
2.  ポケモンショーダウンは、エージェントがライブのポケモンバトルを行うオープンソースのバトルシミュレーターです。リアルタイムでバトルをシミュレートして表示するためのフルインターフェースを提供します。このチャレンジでは、ボットはターンごとに動きを選択する人間のプレイヤーのように振る舞います。


### 🔌 LLMAgentBase
3.  LLMAgentBase（エルエルエムエージェントベース）は、Poke-envのPlayerクラスを拡張したPythonクラスです。これは、LLMとポケモンバトルシミュレーターの間のブリッジとして機能し、入出力のフォーマットを処理し、バトルのコンテキストを維持します。このベースエージェントは、環境と対話するための一連のツール（`STANDARD_TOOL_SCHEMA`で定義）を提供します。

#### 🧠 Core Logic
4.  `choose_move(battle: Battle)` は、各ターンに呼び出される主要なメソッドです。これはBattleオブジェクトを取り、LLMの出力に基づいてアクション文字列を返します。内部メソッドとして、`_format_battle_state(battle)` は現在のバトル状態を文字列に変換し、LLMに送信するのに適した形式にします。また、`_find_move_by_name(battle, move_name)` は名前で動きを検索し、`_find_pokemon_by_name(battle, pokemon_name)` はLLMのスイッチコマンドに基づいて切り替える特定のポケモンを見つけます。`_get_llm_decision(battle_state)` はベースクラスでは抽象メソッドであり、LLMにどのようにクエリを送信し、その応答を解析するかを定義する独自のエージェントで実装する必要があります。

#### 🔧 Key Internal Methods

### 🧪 TemplateAgent
5.  TemplateAgent（テンプレートエージェント）は、LLMAgentBaseを基盤として、独自の戦略を持つ独自のエージェントを実装するためのテンプレートです。このテンプレートから開始して独自のロジックを構築します。また、OpenAI、Mistral、およびGeminiモデルを使用した3つの完全な例も提供されています。`_get_llm_decision` メソッド内で、システムプロンプトとユーザプロンプトを定義し、LLMからの応答を処理して行動を決定します。



## Launching Your Pokemon Battle Agent
### Battle the Stream Agent!",
### Pokémon Battle Agent Challenger"
#### How to Launch Your Agent

1. このコースは、エージェントの作成と、特にポケモンバトルエージェントの構築に焦点を当てています。コースの紹介、AIエージェントのフレームワーク（smolagents、LlamaIndex、LangGraph）、Agentic RAGの使用例、最終プロジェクト（エージェントの作成、テスト、認定）、およびボーナスユニット（LLMのファインチューニング、エージェントの可観測性、ポケモンゲームにおけるエージェント）で構成されています。

2. 自身のポケモンバトルエージェントを構築する代わりに、Twitchでの自動ライブストリームを通じて、エージェントのバトル能力を体験できます。参加者は、ポケモンShowdownスペースにアクセスし、現在のエージェントのユーザー名を検索し、バトル招待を送信することで、ストリーム内のエージェントと対戦できます。ただし、一度にオンラインになるエージェントは1つだけなので、正しい名前を確認する必要があります。

3. 自身のポケモンバトルエージェントをテストしたい場合は、専用のHugging Face Spaceを利用できます。このSpaceはポケモンShowdownサーバーに接続されており、AIエージェント同士の対戦が可能です。Spaceを複製し、自身のコードを`agent.py`に追加し、`app.py`にエージェントの名前とロジックを登録することで、エージェントをアリーナに投入できます。

4. エージェントをHugging Face Spaceで起動するには、まずSpaceを複製します。次に、`agent.py`ファイルに自身のエージェントの実装をペーストし、`app.py`でエージェントの名前とロジックをドロップダウンメニューに追加します。その後、ドロップダウンメニューからエージェントを選択し、ポケモンShowdownのユーザー名を入力して、バトル招待を送信します。招待が画面に表示されたら、バトルを受け入れて対戦を開始できます。

