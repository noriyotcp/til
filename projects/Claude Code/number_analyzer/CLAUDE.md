# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

Rubyを使い、リファクタリング対象のコード生成からClaude Codeに任せるという進め方、素晴らしいですね。Claude Codeのコード生成能力とリファクタリング能力の両方を体験できる、とても良いプロジェクトになります。

では、具体的な手順を詰めていきましょう。

### **ステップ1：リファクタリング対象の「少しイケてない」Rubyコードを生成させる**

まず、わざと「改善の余地がある」コードをClaude Codeに作らせます。完成された綺麗なコードが出てきてしまうとリファクタリングの練習にならないため、プロンプトで少し工夫するのがポイントです。

**お題：**
数値の配列を受け取り、その**合計、平均、最大値、最小値**を計算して表示するRubyスクリプト

**手順：**
1.  任意の作業ディレクトリを作成し、ターミナルでそのディレクトリに移動します。
2.  ターミナルで `claude` と入力して、Claude Codeを起動します。
3.  起動したら、Claude Codeに対して次のようなプロンプトを入力します。

> あなたはRuby初心者という設定で、以下の要件を満たすRubyスクリプトを `number_analyzer.rb` というファイル名で作成してください。
>
> **要件：**
> *   数値の配列をハードコードで持つ
> *   その配列の合計、平均、最大値、最小値を計算して出力する
> *   **重要：** Rubyの便利な組み込みメソッド（`sum`, `max`, `min`など）はあえて使わず、基本的なループ処理（`each`など）を使って計算ロジックを実装してください。変数名も `arr` や `val` のようなシンプルなものにしてください。

このように依頼することで、意図的に冗長で、変数名も素っ気ない、リファクタリングのしがいがあるコードを生成させることができます。

---

### **ステップ2：生成されたコードをリファクタリングさせる**

ステップ1で `number_analyzer.rb` が無事に生成されたら、いよいよリファクタリングの依頼をします。

**手順：**
1.  （Claude Codeを続けて使っている場合はそのままでOKです）Claude Codeが `number_analyzer.rb` を認識している状態で、次のようなプロンプトを入力します。

> `number_analyzer.rb` のコードを、もっとRubyらしく、プロフェッショナルな書き方にリファクタリングしてください。
>
> **改善してほしい点：**
> *   ループ処理を使っている箇所を、Rubyの適切な組み込みメソッド（`sum`, `max`, `min`など）に置き換えて、コードを簡潔にしてください。
> *   変数名を、`numbers` や `average` のように、より意味が分かりやすい名前に変更してください。
> *   もし可能であれば、計算ロジックをメソッドとして切り出してください。

**Claude Codeの動き（予測）：**
この指示を受け取ると、Claude Codeは `number_analyzer.rb` の内容を読み込み、指示に従ってリファクタリング案を提示してきます。多くの場合、変更前と変更後のコードを差分（diff）形式で見せてくれるので、どのような変更が行われるかを明確に確認できます。

**最終ステップ：**
変更内容に問題がなければ、Claude Codeに「適用して」「`accept`」などと伝えて、ファイルを実際に書き換えてもらいましょう。

---

まずはこの**ステップ1**から試してみてはいかがでしょうか。Claude Codeがどのような「初心者風」のコードを生成してくるかを見るだけでも面白い体験になるはずです。

## Development Commands

Ruby実行: `ruby number_analyzer.rb`
テスト実行: `ruby -r minitest/autorun test_*.rb` (テストファイル作成後)
Lint実行: `rubocop` (RuboCop導入後)

## Architecture

Project architecture will be documented as the codebase develops.

## Future Improvements for CLAUDE.md

以下の改善提案を実装予定：

### 1. CLAUDE.mdの本来の目的との整合性向上
- [ ] 学習手順書的な内容と開発ガイダンス的な内容を整理
- [ ] 将来のClaude Codeインスタンス向けの実用的な情報を充実

### 2. Ruby固有の開発情報の追加
- [ ] テスト実行コマンドの詳細化
- [ ] Lintツール（RuboCop等）の設定と実行方法
- [ ] Gemfile管理やバージョン情報

### 3. プロジェクト構成の動的更新
- [ ] number_analyzer.rb作成後のファイル構成反映
- [ ] 実際のコード構造に基づいたアーキテクチャ情報
