---
date: "2024-09-13 00:37:58 +0900"
last_modified_at: "2024-09-17 02:26:10 +0900"
---

# Part 1: Exploring Rails and Its Abstractions

## Chapter 1: Rails as a Web Application Framework

### The journey of a click through Rails abstraction layers
Railsアプリケーションにおけるクリックの処理を、以下の層を通じて説明します。
1. **Webリクエストとアーキテクチャ**: レイヤードアーキテクチャの適用理由とWebアプリケーションのライフサイクル。
2. **Rack**: HTTPリクエストとRubyアプリケーション間のインターフェース。
3. **Railsルーティング**: リクエストを適切なコントローラアクションにマッピング。
4. **コントローラ**: リクエストをビジネスロジックに変換し、UIを更新。
5. **リクエスト外の処理**: バックグラウンドジョブなどによる非同期処理。

### trace_locationとは
`trace_location` gemは、ライブラリやフレームワークの内部処理を追跡するためのツールで、RubyのTracePoint APIを使用。これは、メソッドの呼び出しや戻りをトレースし、Railsアプリケーションのリクエスト-レスポンスサイクル中のRubyメソッドコールを追跡するのに役立つ。

### Beyond requests – background and scheduled tasks
バックグラウンドジョブとスケジュールジョブにより、HTTPリクエスト以外の作業を効率的に処理する方法を説明。

- **背景ジョブの必要性**: スループットを向上させるための非同期処理。
- **ジョブとキューの抽象**: ジョブの定義とキューの利用。
- **スケジュールされたジョブ**: クロックトリガーによるジョブとそのスケジューリング方法。
- **バックグラウンドジョブのエコシステム**: SidekiqやActive Jobの使用。

### ActiveJobの導入の背景
ActiveJobは、さまざまなバックグラウンドジョブライブラリの統一されたインターフェースを提供し、ジョブのスケジューリングとエンキューイングをシンプルにする。

### The heart of a web application – the database
データベースがウェブアプリケーションの中心的な役割を果たし、パフォーマンスと抽象化のトレードオフについて説明。

- **データベースの重要性**: データベースの健全性がアプリケーションパフォーマンスに与える影響。
- **抽象化とパフォーマンスのトレードオフ**: 過度な抽象化がパフォーマンスに及ぼす影響。
  - 抽象化の目的: 抽象化は実装の詳細を隠すために使用されるが、必ずしもパフォーマンスの向上に繋がるわけではない。例えば、データベースに対する簡単なインサート操作も、抽象化が過度に使用されるとパフォーマンスに悪影響を及ぼすことがある。
  - データベースレイヤーでの処理: 一部の機能はデータベースレベルで処理する方がパフォーマンスと生産性の両方でメリットがある。例えば、監査記録の保持や論理削除（soft deletion, レコードを削除する代わりに「削除済み」とマークする）などの機能は、アプリケーションコードで実装するのではなく、データベースのトリガやカスタムタイプを使用する方が効率的である。
- **データベースアブストラクションの戦略**: 一貫性を保つためのビジネスロジックのデータベースレイヤーへの移行。

以上が概要で、各コンポーネントがどのように連携してWebアプリケーションを構築し、効率的に動作させるかについて学びます。

